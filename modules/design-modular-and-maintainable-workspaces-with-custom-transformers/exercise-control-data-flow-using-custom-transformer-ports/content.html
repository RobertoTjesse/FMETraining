<h2 id="custom-transformer-input-output-ports">
  <span>Custom Transformer Input/Output Ports</span>
</h2>
<p>Again, like a normal FME transformer, a custom transformer has a number of input and output ports:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.012.CustomTransformerInputOutputPorts.png" alt class="image image-block image-center" /></p>
<p>These input and output ports are defined by input/output objects in the custom transformer definition itself:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.013.CustomTransformerDefInputOutputPorts.png" alt class="image image-block image-center" /></p>
<h2 id="renaming-ports">
  <span>Renaming Ports</span>
</h2>
<p>The first thing to know is that these input/output objects can be renamed, in order that the transformer ports get named appropriately. You can either double-click the object, choose Rename from the context menu, or press F2, in order to rename the object.</p>
<p>For example, here the user pressed F2 and renames the input port from StringConcatenator_Input to simply Input:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.014.CustomTransformerRenamingPort.png" alt class="image image-block image-center" /></p>
<p>Renaming the input and output ports is useful for making the custom transformer intentions more explicit; for instance, helping the user to understand what data type is required as input.</p>
<p>For example, after editing the transformer might look like this:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.015.CustomTransformerRenamedPort.png" alt class="image image-block image-center" /></p>
<hr />
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td>FME Lizard says...</td>
    </tr>
    <tr>
      <td>Here the user simply renamed the input port to Input. Renaming it to "Strings", "Lines", or "Raster" (for example) would help guide other users of the transformer as to what data is required.<br /><br />However, they did rename the output port to illustrate the type of data that will emerge.</td>
    </tr>
  </tbody>
</table>
<hr />
<h2 id="adding-or-removing-ports">
  <span>Adding or Removing Ports</span>
</h2>
<p>Besides renaming ports, it is also possible to add new ports to a custom transformer.</p>
<p>To do so simply select Transformer Input (or Output) from either the menubar or the canvas context (right-click) menu:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.016.AddCustomTransformerInputPort.png" alt class="image image-block image-center" /></p>
<p>For example, here a user has ports to handle two streams of input data and two streams of output (one port for the required output, another that handles rejected features:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.017.CustomTransformerMultiInputOutputPorts.png" alt class="image image-block image-center" /></p>
<p>This means that each instance of the custom transformer has two input and two output ports:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.018.CustomTransformerMultiInputOutputPorts.png" alt class="image image-block image-center" /></p>
<hr />
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td>FME Lizard asks...</td>
    </tr>
    <tr>
      <td>
        <p>Q) Which of these is NOT a reason to use Custom Transformers?</p>To make my content available in Quick AddTo use advanced functionality like loopingTo reuse chunks of content in a simple wayTo tidy and declutter the main workspace canvasCheckShow explanationShow correct answers<p>Q) Consider this section of workspace:<br /><br /><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.019.CustomTransformerCreationWhatPorts.png" class="image image-block image-center" /><br /><br />If I select the three transformers highlighted with arrows, and create a custom transformer, how many input and output ports will it have by default?</p>One Input and One Output portOne Input and Two Output portsTwo Input and Two Output portsTwo Input and Three Output ports
      </td>
    </tr>
  </tbody>
</table>
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td>Exercise 2</td>
      <td>Editing a Custom Transformer</td>
    </tr>
    <tr>
      <td>Data</td>
      <td>Neighborhoods (Google KML)</td>
    </tr>
    <tr>
      <td>Overall Goal</td>
      <td>Make use of a custom transformer created out of a workspace</td>
    </tr>
    <tr>
      <td>Demonstrates</td>
      <td>Basic custom transformer re-use and editing</td>
    </tr>
    <tr>
      <td>Start Workspace</td>
      <td>C:\FMEData2019\Workspaces\DesktopAdvanced\CustomTransformers-Ex2-Begin.fmw</td>
    </tr>
    <tr>
      <td>End Workspace</td>
      <td>C:\FMEData2019\Workspaces\DesktopAdvanced\CustomTransformers-Ex2-Complete.fmw</td>
    </tr>
  </tbody>
</table>
<p>A colleague - new to FME - has created a workspace that calculates the population density for neighborhoods in the city of Vancouver, and comments that this technique could be reused for other projects.</p>
<p>We've turned her workspace into a custom transformer as a way of doing this and now need to show how to use it multiple times and apply edits to its definition.</p>
<p><br /><strong>1) Start Workbench</strong><br />Continue with the workspace from exercise 1, or open the workspace: C:\FMEData2019\Workspaces\DesktopAdvanced\CustomTransformers-Ex2-Begin.fmw</p>
<p><br /><strong>2) Duplicate Custom Transformer</strong><br />Notice that we started with two ExpressionEvaluators and now have one ExpressionEvaluator and one custom transformer. Let's place another instance of the custom transformer in place of the ExpressionEvaluator.</p>
<p>Click on the ExpressionEvaluator_2011 and press the delete key to delete it.</p>
<p>Click on the DensityEvaluator custom transformer and press Ctrl+D (or right-click &gt; duplicate) to create a duplicate copy of it. This is the same effect as placing a new instance, but quicker. You could do the same task through Quick Add or the Transformer Gallery if you desired.</p>
<p>Connect the second DensityEvaluator into the workflow, in parallel and not in series:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.204.Ex2.CTOnCanvasReused.png" alt class="image image-block image-center" /></p>
<p><br /><strong>3) Set Custom Transformer Parameters</strong><br />By creating a second instance of the custom transformer we've started to re-use our content, which is great. However, the second instance is currently processing the wrong data.</p>
<p>Inspect the parameters for the second DensityEvaluator and set the population parameter to TotalPopulation2011 (not 2001):</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.205.Ex2.CTReusedEditParameter.png" alt class="image image-block image-center" /></p>
<p><br /><strong>4) Run Workspace</strong><br />Run the workspace and inspect the output to ensure the data is being processed correctly.</p>
<p>One obvious problem with the output from the transformer is that the result is put into an attribute called PopulationDensity2001, regardless of what data is being processed.</p>
<p>This is not useful; for example, the 2011 results also get the same name, as would any other scenario where we used this transformer. We should improve this by making the output name more generic.</p>
<p><br /><strong>5) Edit Custom Transformer</strong><br />Click on the tab labeled DensityEvaluator to switch the canvas to the custom transformer definition. Inspect the ExpressionEvaluator_2001 parameters. Change the Transformer name to ExpressionEvaluator since we are processing more than just 2001 data. Then change the name of the New Attribute parameter to DensityResult:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.206.Ex2.CTEditExpressionEvalParameter.png" alt class="image image-block image-center" /></p>
<p>If you run the workspace again (run it from at least the custom transformer onwards) you’ll notice that DensityResult is the attribute output by both instances of the custom transformer; i.e. one edit has fixed both of them!</p>
<p><br /><strong>6) Rename Ports</strong><br />One other edit we ought to make is to the port names of the custom transformer. At the moment they are not very elegant.</p>
<p>Back within the DensityEvaluator tab, click the cogwheel icon of the input port object (currently labeled AreaCalculator_Input). Inspect its parameters and change the name to Input.</p>
<p>Now repeat the process for the output port object, renaming it to Output:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.207.Ex2.CTRenamingPorts.png" alt class="image image-block image-center" /></p>
<p>Click the Main tab to check back on the main canvas and confirm the changes have been made:</p>
<p><img src="https://s3.amazonaws.com/gitbook/Desktop-Advanced-2019/DesktopAdvanced5CustomTransformers/Images/Img5.208.Ex2.CTRenamedPorts.png" alt class="image image-block image-center" /></p>
<p>You'll need to manually resize the transformers to fit their new naming style, as in the above image.</p>
<hr />
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td>CONGRATULATIONS</td>
    </tr>
    <tr>
      <td>By completing this exercise you have learned how to:<ul>
          <li>Use multiple instances of a custom transformer</li>
          <li>Make a custom transformer generic for use anywhere</li>
          <li>Rename input and output ports in a custom transformer</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
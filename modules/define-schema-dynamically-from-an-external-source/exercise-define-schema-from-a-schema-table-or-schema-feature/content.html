<h2 id="learning-objectives">
  <span>Learning Objectives</span>
</h2>
<p>After completing this unit, you’ll be able to:</p>
<ul>
  <li>Set up a spreadsheet for use as a dynamic translation schema.</li>
  <li>Use the Schema (from Table) reader to read a schema from a spreadsheet.</li>
  <li>Use the Schema From Schema Feature schema source to use schema from a schema feature.</li>
</ul>
<h2 id="resources">
  <span>Resources</span>
</h2>
<ul>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Workspaces/AdvancedReadingAndWriting/exercise-define-schema-from-a-schema-table-or-schema-feature.fmw" rel="noreferrer noopener" target="_blank">Starting workspace</a>
    <ul>
      <li>If your computer has FMEData2022, the file path is C:\FMEData2022\Workspaces\AdvancedReadingAndWriting\exercise-define-schema-from-a-schema-table-or-schema-feature.fmw</li>
    </ul>
  </li>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Workspaces/AdvancedReadingAndWriting/exercise-define-schema-from-a-schema-table-or-schema-feature-complete.fmw" rel="noreferrer noopener" target="_blank">Completed workspace</a>
    <ul>
      <li>C:\FMEData2022\Workspaces\AdvancedReadingAndWriting\exercise-define-schema-from-a-schema-table-or-schema-feature-complete.fmw</li>
    </ul>
  </li>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Resources/DesktopAdvanced/CommunityMapSchema.xlsx" rel="noreferrer noopener" target="_blank">CommunityMapSchema.xlsx</a>
    <ul>
      <li>C:\FMEData2022\Resources\DesktopAdvanced\CommunityMapSchema.xlsx</li>
    </ul>
  </li>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Resources/DesktopAdvanced/CommunityMapAdvancedSchema.xlsx" rel="noreferrer noopener" target="_blank">CommunityMapAdvancedSchema.xlsx</a>
    <ul>
      <li>C:\FMEData2022\Resources\DesktopAdvanced\CommunityMapSchema.xlsx</li>
    </ul>
  </li>
  <li><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Data/Zoning.zip" rel="noreferrer noopener" target="_blank">Zoning.zip</a>
    <ul>
      <li>C:\FMEData2022\Data\Zoning\Zones.tab</li>
    </ul>
  </li>
</ul>
<h2 id="introduction">
  <span>Introduction</span>
</h2>
<p>In the past exercise, you created a new community map dataset for the planning department using a dynamic schema. We defined only two tables at the time, but now another is required, and the planning department wants you to update the workspace.</p>
<p>Rather than making changes each time they add more datasets, you believe you can create an Excel spreadsheet containing the schema definition. That way, the planning team can edit it themselves and do the same for all future updates.</p>
<h2 id="1-inspect-spreadsheet">
  <span>1) Inspect Spreadsheet</span>
</h2>
<p>Open and examine the spreadsheet <a href="https://s3.amazonaws.com/FMEData/FMEData2022/Resources/DesktopAdvanced/CommunityMapSchema.xlsx" rel="noreferrer noopener" target="_blank">CommunityMapSchema.xlsx</a> (or C:\FMEData2022\Resources\DesktopAdvanced\CommunityMapSchema.xlsx).</p>
<p>If you don’t have Excel, open it in the FME Data Inspector and switch to Table View.</p>
<p><img src="images/1673653632337.png" class="image image-block image-center" alt="Schema defined in an Excel table" /></p>
<p>The table has schema definitions for Firehalls, Parks, and Zones feature types. You can see how each new table has a series of attributes defined for it (each attribute is a separate row in the spreadsheet), including attribute type and attribute order. Geometry type only needs to be defined once per table.</p>
<h2 id="2-start-workbench">
  <span>2) Start Workbench</span>
</h2>
<p>Start FME Workbench (2022.1 or later). Open the workspace from the previous exercise or the <a href="https://s3.amazonaws.com/FMEData/FMEData2022/Workspaces/AdvancedReadingAndWriting/exercise-define-schema-from-a-schema-table-or-schema-feature.fmw" rel="noreferrer noopener" target="_blank">starting workspace</a>.</p>
<p><img src="images/1673653823165.png" class="image image-block image-center" alt="Starting workspace" /></p>
<h2 id="3-delete-community-map-resource-reader">
  <span>3) Delete CommunityMap Resource Reader</span>
</h2>
<p>Because we are using a spreadsheet to define our output schemas, the CommunityMap Resource Reader is no longer needed. Locate it in the Navigator window, right-click it, and choose Delete.</p>
<p><img src="images/1674068367419.png" class="image image-block image-center" alt="Removing the reader resource" /></p>
<p>When prompted, click Yes to confirm that FME will remove all references to this dataset.</p>
<h2 id="4-add-excel-file-as-reader-resource">
  <span>4) Add Excel File as Reader Resource</span>
</h2>
<p>Now select Readers &gt; Add Reader as Resource. In the dialog that opens, choose:</p>
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td><strong>Reader Format</strong></td>
      <td>Schema (From Table)</td>
    </tr>
    <tr>
      <td><strong>Reader Dataset</strong></td>
      <td><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Resources/DesktopAdvanced/CommunityMapAdvancedSchema.xlsx" rel="noreferrer noopener" target="_blank">https://s3.amazonaws.com/FMEData/FMEData2022/Resources/DesktopAdvanced/CommunityMapAdvancedSchema.xlsx</a> or C:\FMEData2022\Resources\DesktopAdvanced\CommunityMapSchema.xlsx</td>
    </tr>
  </tbody>
</table>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://res.cloudinary.com/hy4kyit2a/image/upload/doc/trailhead/en-usb473bb5ea1b7e61dfb07e6a7e547de6b.gif" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>Be sure to use the Schema (From Table) format and not the Excel format!</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p>Click the Parameters button (OK will be greyed-out until you do). This dialog is where we can define how the table maps to the required schema.</p>
<p>Check the reader parameters at the top. They should show the dataset is an Excel format file. Select Sheet1 under the Select Table parameter if it is not already selected:</p>
<p><img src="images/1674068506509.png" class="image image-block image-center" alt="Select Sheet1" /></p>
<p>The first row should get used as the field names. If this is not the case, then click the parameters button above and set the values correctly:</p>
<p>Next, select the appropriate fields to match the required parameters (for example, Feature Type = FeatureType):</p>
<p><img src="images/1673654482467.png" class="image image-block image-center" alt="Matching column names to their function" /></p>
<p>Click OK to close the dialog and again to add the resource reader.</p>
<div class="box message info">
  <div class="inner">
    <div class="bd">
      <div class="media">
        <img class="img mtm" role="presentation" src="https://res.cloudinary.com/hy4kyit2a/image/upload/doc/trailhead/en-usb473bb5ea1b7e61dfb07e6a7e547de6b.gif" alt="Note" />
        <div class="mediaBd">
          <div class="message-media-content">
            <p>You can give the fields in such a lookup table any name you desire. In this example, we used the same name as the parameter to make the relationship obvious. Some of them (Geometry Type and Attribute Sequence) are optional and don’t have to be part of the schema definition if not needed.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="5-set-dynamic-parameters">
  <span>5) Set Dynamic Parameters</span>
</h2>
<p>Now inspect the feature type parameters for the writer feature type.</p>
<p>Under the User Attributes tab, remove the LastUpdatedBy attribute, as we’ve added this to the spreadsheet definition for each type and no longer need it here.</p>
<p>In the Parameters tab, click the Schema Sources edit button. Uncheck FireHalls and check CommunityMapSchema [SCHEMA_FROM_TABLE]:</p>
<p><img src="images/1673654516191.png" class="image image-block image-center" alt="Setting Schema Source to Schema From Table" /></p>
<p>Accept the changes to these parameters.</p>
<h2 id="6-add-reader">
  <span>6) Add Reader</span>
</h2>
<p>If you noticed, the schema spreadsheet included an entry for the Zones dataset, so add a reader (not a Resource – we want the data this time) as follows:</p>
<table class="featureTable sort_table">
  <tbody class="tbody">
    <tr>
      <td><strong>Reader Format</strong></td>
      <td>MapInfo TAB (MITAB)</td>
    </tr>
    <tr>
      <td><strong>Reader Dataset</strong></td>
      <td><a href="https://s3.amazonaws.com/FMEData/FMEData2022/Data/Zoning.zip" rel="noreferrer noopener" target="_blank">https://s3.amazonaws.com/FMEData/FMEData2022/Data/Zoning.zip</a> or C:\FMEData2022\Data\Zoning\Zones.tab</td>
    </tr>
  </tbody>
</table>
<p>Once added, connect its reader feature type to the dynamic writer feature type.</p>
<p><img src="images/1673654555212.png" class="image image-block image-center" alt="Zoning reader feature type added" /></p>
<h2 id="7-save-and-run-workspace">
  <span>7) Save and Run Workspace</span>
</h2>
<p>Save the workspace and then run it.</p>
<p>Inspect the output. Notice that FME has written all three feature types, and their attribute schema matches what we defined in the Excel spreadsheet, including the LastUpdatedBy field for each one.</p>
<p>However, we still have not instructed FME on how to link the new, externally defined schema and the existing one. For this reason, all of the new attributes defined in the external schema table have missing values in the output data. We’ll examine how to address this issue using the SchemaMapper in the next exercise.</p>